<!DOCTYPE html>
<html lang="en">
  <head><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">

<meta name="description" content="222222"/><link rel="alternate" href="/atom.xml" title="K1rit0's Blog" type="application/atom+xml"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.11.0" />
<link rel="canonical" href="http://tearsjin.github.io/page/4/"/>

<link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css" /><script type="text/x-mathjax-config">
    MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
  </script>
  <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.11.0" />

<script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>
<script>
  window.config = {"leancloud":{"app_id":null,"app_key":null},"toc":true,"fancybox":true,"pjax":"","latex":true};
</script>

    <title>K1rit0's Blog</title>
  <meta name="generator" content="Hexo 5.4.0"></head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">K1rit0's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list"><a href="/">
        <li class="mobile-menu-item">Home
          </li>
      </a><a href="/archives/">
        <li class="mobile-menu-item">Archives
          </li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags
          </li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories
          </li>
      </a><a href="/about/">
        <li class="mobile-menu-item">About
          </li>
      </a><a href="/link/">
        <li class="mobile-menu-item">Link
          </li>
      </a></ul>
</nav>
<div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">K1rit0's Blog</a>
</div>

<nav class="site-navbar"><ul id="menu" class="menu"><li class="menu-item">
          <a class="menu-item-link" href="/">
            Home
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            Archives
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/tags/">
            Tags
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/categories/">
            Categories
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/about/">
            About
            </a>
        </li>
      <li class="menu-item">
          <a class="menu-item-link" href="/link/">
            Link
            </a>
        </li>
      </ul></nav>
</header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content"><section id="posts" class="posts"><article class="post">
    <header class="post-header">
      <h1 class="post-title"><a class="post-link" href="/2021/09/18/writeup-for-2021-%E7%AC%AC%E4%BA%94%E7%A9%BA%E9%97%B4/">writeup-for-2021-第五空间</a>
        </h1>

      <div class="post-meta">
        <span class="post-time">
          2021-09-18
        </span><span class="post-category">
            <a href="/categories/WriteUp/">WriteUp</a>
            </span>
        </div>
    </header>

    <div class="post-content"><blockquote>
<p>算是第一次AK密码?</p>
</blockquote>
<h1 id="ecc"><a href="#ecc" class="headerlink" title="ecc"></a>ecc</h1><h2 id="problem"><a href="#problem" class="headerlink" title="problem"></a>problem</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Try to solve the 3 ECC&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">assert</span>(flag[:<span class="number">5</span>]==<span class="string">&#x27;flag&#123;&#x27;</span>)</span><br><span class="line">flag = flag[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line">num1 = bytes_to_long(flag[:<span class="number">7</span>])</span><br><span class="line">num2 = bytes_to_long(flag[<span class="number">7</span>:<span class="number">14</span>])</span><br><span class="line">num3 = bytes_to_long(flag[<span class="number">14</span>:])</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ECC1</span>(<span class="params">num</span>):</span></span><br><span class="line">	p = <span class="number">146808027458411567</span></span><br><span class="line">	A = <span class="number">46056180</span></span><br><span class="line">	B = <span class="number">2316783294673</span></span><br><span class="line">	E = EllipticCurve(GF(p),[A,B])</span><br><span class="line">	P = E.random_point() </span><br><span class="line">	Q = num*P</span><br><span class="line">	<span class="built_in">print</span> E</span><br><span class="line">	<span class="built_in">print</span> <span class="string">&#x27;P:&#x27;</span>,P</span><br><span class="line">	<span class="built_in">print</span> <span class="string">&#x27;Q:&#x27;</span>,Q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ECC2</span>(<span class="params">num</span>):</span></span><br><span class="line">	p = <span class="number">1256438680873352167711863680253958927079458741172412327087203</span></span><br><span class="line">	<span class="comment">#import random</span></span><br><span class="line">	<span class="comment">#A = random.randrange(389718923781273978681723687163812)</span></span><br><span class="line">	<span class="comment">#B = random.randrange(816378675675716537126387613131232121431231)</span></span><br><span class="line">	A = <span class="number">377999945830334462584412960368612</span></span><br><span class="line">	B = <span class="number">604811648267717218711247799143415167229480</span></span><br><span class="line">	E = EllipticCurve(GF(p),[A,B])</span><br><span class="line">	P = E.random_point() </span><br><span class="line">	Q = num*P</span><br><span class="line">	<span class="built_in">print</span> E</span><br><span class="line">	<span class="built_in">print</span> <span class="string">&#x27;P:&#x27;</span>,P</span><br><span class="line">	<span class="built_in">print</span> <span class="string">&#x27;Q:&#x27;</span>,Q</span><br><span class="line">	factors, exponents = <span class="built_in">zip</span>(*factor(E.order()))</span><br><span class="line">	primes = [factors[i] ^ exponents[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(factors))][:-<span class="number">1</span>]</span><br><span class="line">	<span class="built_in">print</span> primes</span><br><span class="line">	dlogs = []</span><br><span class="line">	<span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">		t = <span class="built_in">int</span>(<span class="built_in">int</span>(P.order()) / <span class="built_in">int</span>(fac))</span><br><span class="line">		dlog = discrete_log(t*Q,t*P,operation=<span class="string">&quot;+&quot;</span>)</span><br><span class="line">		dlogs += [dlog]</span><br><span class="line">		print(<span class="string">&quot;factor: &quot;</span>+<span class="built_in">str</span>(fac)+<span class="string">&quot;, Discrete Log: &quot;</span>+<span class="built_in">str</span>(dlog)) <span class="comment">#calculates discrete logarithm for each prime order</span></span><br><span class="line">	<span class="built_in">print</span> num</span><br><span class="line">	<span class="built_in">print</span> crt(dlogs,primes)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ECC3</span>(<span class="params">num</span>):</span></span><br><span class="line">	p = <span class="number">0xd3ceec4c84af8fa5f3e9af91e00cabacaaaecec3da619400e29a25abececfdc9bd678e2708a58acb1bd15370acc39c596807dab6229dca11fd3a217510258d1b</span></span><br><span class="line">	A = <span class="number">0x95fc77eb3119991a0022168c83eee7178e6c3eeaf75e0fdf1853b8ef4cb97a9058c271ee193b8b27938a07052f918c35eccb027b0b168b4e2566b247b91dc07</span></span><br><span class="line">	B = <span class="number">0x926b0e42376d112ca971569a8d3b3eda12172dfb4929aea13da7f10fb81f3b96bf1e28b4a396a1fcf38d80b463582e45d06a548e0dc0d567fc668bd119c346b2</span></span><br><span class="line">	E = EllipticCurve(GF(p),[A,B])</span><br><span class="line">	P = E.random_point() </span><br><span class="line">	Q = num*P</span><br><span class="line">	<span class="built_in">print</span> E</span><br><span class="line">	<span class="built_in">print</span> <span class="string">&#x27;P:&#x27;</span>,P</span><br><span class="line">	<span class="built_in">print</span> <span class="string">&#x27;Q:&#x27;</span>,Q</span><br><span class="line"></span><br><span class="line">ECC1(num1)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;==============&#x27;</span></span><br><span class="line">ECC2(num2)</span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;==============&#x27;</span></span><br><span class="line">ECC3(num3)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>不懂, 为啥题目里还有PolligHellman的代码的 提示?</p>
<p>前两个ecc就用PolligHellman就能解出来</p>
<p>剩下最后一个用smart’s attack</p>
<p>参考论文<a target="_blank" rel="noopener" href="https://wstein.org/edu/2010/414/projects/novotney.pdf"><strong>https://wstein.org/edu/2010/414/projects/novotney.pdf</strong></a></p>
<h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes,bytes_to_long</span><br><span class="line"><span class="comment"># Define the curve</span></span><br><span class="line"></span><br><span class="line">p = <span class="number">146808027458411567</span></span><br><span class="line">a = <span class="number">46056180</span></span><br><span class="line">b = <span class="number">2316783294673</span></span><br><span class="line"><span class="comment"># Generator</span></span><br><span class="line">g_x = <span class="number">119851377153561800</span></span><br><span class="line">g_y = <span class="number">50725039619018388</span></span><br><span class="line">F = FiniteField(p)</span><br><span class="line">E = EllipticCurve(F,[a,b])</span><br><span class="line">G = E.point((g_x, g_y))</span><br><span class="line">n = G.order()</span><br><span class="line">print(n.factor())</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">2^2 * 7 * 193 * 110603 * 122811083</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">primes = [<span class="number">4</span> , <span class="number">7</span> , <span class="number">193</span> , <span class="number">110603</span> , <span class="number">122811083</span>]</span><br><span class="line">x=<span class="number">22306318711744209</span></span><br><span class="line">y=<span class="number">111808951703508717</span></span><br><span class="line">C = E.point((x, y))</span><br><span class="line">dlogs = []</span><br><span class="line"><span class="keyword">for</span> fac <span class="keyword">in</span> primes:</span><br><span class="line">    t = <span class="built_in">int</span>( n // fac )</span><br><span class="line">    dlog = discrete_log( t*C , t*G, operation=<span class="string">&#x27;+&#x27;</span> )</span><br><span class="line">    dlogs += [dlog]</span><br><span class="line">    print(<span class="string">&quot;factor:&quot;</span>+<span class="built_in">str</span>(fac)+<span class="string">&quot;,Discrete Log:&quot;</span>+<span class="built_in">str</span>(dlog))</span><br><span class="line">nC = crt(dlogs,primes)</span><br><span class="line">print(long_to_bytes(nC))</span><br><span class="line"><span class="comment"># 第二条曲线跟第一条曲线是一样的 就不再抄一遍了</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">p = <span class="number">0xd3ceec4c84af8fa5f3e9af91e00cabacaaaecec3da619400e29a25abececfdc9bd678e2708a58acb1bd15370acc39c596807dab6229dca11fd3a217510258d1b</span></span><br><span class="line">A = <span class="number">0x95fc77eb3119991a0022168c83eee7178e6c3eeaf75e0fdf1853b8ef4cb97a9058c271ee193b8b27938a07052f918c35eccb027b0b168b4e2566b247b91dc07</span></span><br><span class="line">B = <span class="number">0x926b0e42376d112ca971569a8d3b3eda12172dfb4929aea13da7f10fb81f3b96bf1e28b4a396a1fcf38d80b463582e45d06a548e0dc0d567fc668bd119c346b2</span></span><br><span class="line">E =EllipticCurve(GF(p),[A,B])</span><br><span class="line"></span><br><span class="line">g_x = <span class="number">10121571443191913072732572831490534620810835306892634555532657696255506898960536955568544782337611042739846570602400973952350443413585203452769205144937861</span></span><br><span class="line">g_y = <span class="number">8425218582467077730409837945083571362745388328043930511865174847436798990397124804357982565055918658197831123970115905304092351218676660067914209199149610</span></span><br><span class="line">G = E.point((g_x, g_y))</span><br><span class="line">x=<span class="number">964864009142237137341389653756165935542611153576641370639729304570649749004810980672415306977194223081235401355646820597987366171212332294914445469010927</span></span><br><span class="line">y=<span class="number">5162185780511783278449342529269970453734248460302908455520831950343371147566682530583160574217543701164101226640565768860451999819324219344705421407572537</span></span><br><span class="line">C = E.point((x, y))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">HenselLift</span>(<span class="params">P,p,prec</span>):</span> </span><br><span class="line">    E = P.curve()     </span><br><span class="line">    Eq = E.change_ring(QQ) </span><br><span class="line">    Ep = Eq.change_ring(Qp(p,prec)) </span><br><span class="line">    x_P,y_P = P.xy() </span><br><span class="line">    x_lift = ZZ(x_P) </span><br><span class="line">    y_lift = ZZ(y_P) </span><br><span class="line">    x, y, a1, a2, a3, a4, a6 = var(<span class="string">&#x27;x,y,a1,a2,a3,a4,a6&#x27;</span>) </span><br><span class="line">    f(a1,a2,a3,a4,a6,x,y) = y^<span class="number">2</span> + a1*x*y + a3*y - x^<span class="number">3</span> - a2*x^<span class="number">2</span> - a4*x - a6 </span><br><span class="line">    g(y) = f(ZZ(Eq.a1()),ZZ(Eq.a2()),ZZ(Eq.a3()),ZZ(Eq.a4()),ZZ(Eq.a6()),ZZ(x_P),y) </span><br><span class="line">    gDiff = g.diff() </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,prec): </span><br><span class="line">        uInv = ZZ(gDiff(y=y_lift)) </span><br><span class="line">        u = uInv.inverse_mod(p^i)       </span><br><span class="line">        y_lift = y_lift - u*g(y_lift) </span><br><span class="line">        y_lift = ZZ(Mod(y_lift,p^(i+<span class="number">1</span>))) </span><br><span class="line">    y_lift = y_lift+O(p^prec) </span><br><span class="line">    <span class="keyword">return</span> Ep([x_lift,y_lift]) </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">SmartAttack</span>(<span class="params">P,Q,p,prec</span>):</span> </span><br><span class="line">    E = P.curve() </span><br><span class="line">    Eqq = E.change_ring(QQ) </span><br><span class="line">    Eqp = Eqq.change_ring(Qp(p,prec)) </span><br><span class="line"></span><br><span class="line">    P_Qp = HenselLift(P,p,prec)     </span><br><span class="line">    Q_Qp = HenselLift(Q,p,prec)     </span><br><span class="line"></span><br><span class="line">    p_times_P = p*P_Qp </span><br><span class="line">    p_times_Q=p*Q_Qp </span><br><span class="line">    x_P,y_P = p_times_P.xy() </span><br><span class="line">    x_Q,y_Q = p_times_Q.xy() </span><br><span class="line"></span><br><span class="line">    phi_P = -(x_P/y_P) </span><br><span class="line">    phi_Q = -(x_Q/y_Q)     </span><br><span class="line"></span><br><span class="line">    k = phi_Q/phi_P </span><br><span class="line">    k = Mod(k,p) </span><br><span class="line">    <span class="keyword">return</span> k </span><br><span class="line"></span><br><span class="line">long_to_bytes(SmartAttack(G,C,p,<span class="number">8</span>))</span><br></pre></td></tr></table></figure>



<h1 id="doublesage"><a href="#doublesage" class="headerlink" title="doublesage"></a>doublesage</h1><h2 id="problem-1"><a href="#problem-1" class="headerlink" title="problem"></a>problem</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="keyword">from</span> sage.stats.distributions.discrete_gaussian_integer <span class="keyword">import</span> DiscreteGaussianDistributionIntegerSampler</span><br><span class="line"><span class="keyword">from</span> sage.crypto.lwe <span class="keyword">import</span> LWE</span><br><span class="line"><span class="keyword">from</span> sage.crypto.lwe <span class="keyword">import</span> samples </span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Question</span>(<span class="params">n,m,para_D,para_e</span>):</span>  </span><br><span class="line">	signal.alarm(<span class="number">600</span>)     </span><br><span class="line">	print(<span class="string">&#x27;[+] Question:&#x27;</span>) </span><br><span class="line">	<span class="comment"># m=n^2-2</span></span><br><span class="line">	q=next_prime(n^<span class="number">2</span>)                           </span><br><span class="line">	D=DiscreteGaussianDistributionIntegerSampler(para_D*n)</span><br><span class="line">	lwe=LWE(n=n, q=q, D=D)</span><br><span class="line">	Z=[lwe() <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(m)]</span><br><span class="line">	A=matrix([a <span class="keyword">for</span> (a,c) <span class="keyword">in</span> Z]).transpose()</span><br><span class="line">	C=vector([c <span class="keyword">for</span> (a,c) <span class="keyword">in</span> Z])</span><br><span class="line">	print(<span class="string">&#x27;[+] The following matrix operations are modulus&#x27;</span>,q)</span><br><span class="line">	print(<span class="string">&#x27;\n[+] Matrix A of size&#x27;</span>,n,<span class="string">&#x27;*&#x27;</span>,m,<span class="string">&#x27;:&#x27;</span>); print(A)</span><br><span class="line">	print(<span class="string">&#x27;\n[+] Vector C of size&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;*&#x27;</span>,m,<span class="string">&#x27;:&#x27;</span>); print(np.array(C))</span><br><span class="line">	E=lwe._LWE__s*A-C</span><br><span class="line">	E=[<span class="built_in">int</span>(e) <span class="keyword">for</span> e <span class="keyword">in</span> E]</span><br><span class="line">	E=vector([e <span class="keyword">if</span> e &lt;= floor(q/<span class="number">2</span>) <span class="keyword">else</span> e-q <span class="keyword">for</span> e <span class="keyword">in</span> E])</span><br><span class="line">	E_norm=E.norm().n()*para_e</span><br><span class="line">	print(<span class="string">&#x27;[+] Please give an integer vector x of size&#x27;</span>,<span class="number">1</span>,<span class="string">&#x27;*&#x27;</span>,m,<span class="string">&#x27;(format [1 2 3] or [1, 2, 3]), such that the norm of vector x*A-C &lt;=&#x27;</span>,E_norm,<span class="string">&#x27;, where operations are modulus&#x27;</span>,q,<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">	k=GF(q)^n</span><br><span class="line">	x=k(<span class="number">0</span>)</span><br><span class="line">	u=<span class="built_in">input</span>()</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		u=np.matrix(u)</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">			x[i]=u[<span class="number">0</span>,i]</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">		print(<span class="string">&#x27;[+] Wrong format, exit.&#x27;</span>)</span><br><span class="line">		exit()</span><br><span class="line">	E=x*A-C</span><br><span class="line">	E=[<span class="built_in">int</span>(e) <span class="keyword">for</span> e <span class="keyword">in</span> E]</span><br><span class="line">	E=vector([e <span class="keyword">if</span> e &lt;= floor(q/<span class="number">2</span>) <span class="keyword">else</span> e-q <span class="keyword">for</span> e <span class="keyword">in</span> E])</span><br><span class="line">	tmp=E.norm().n()</span><br><span class="line">	print(<span class="string">&#x27;[+] The norm of vector x*A-C is&#x27;</span>, tmp,<span class="string">&#x27;,&#x27;</span>, tmp&lt;E_norm,<span class="string">&#x27;.\n&#x27;</span>)</span><br><span class="line">	<span class="keyword">if</span> <span class="keyword">not</span> tmp&lt;E_norm:</span><br><span class="line">		exit()</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ReadFlag</span>():</span></span><br><span class="line">	print(<span class="string">&#x27;flag&#123;**********&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">Question(<span class="number">5</span>, <span class="number">23</span>, <span class="number">1.5</span>, <span class="number">1.1</span>)</span><br><span class="line">Question(<span class="number">15</span>, <span class="number">143</span>, <span class="number">1.5</span>, <span class="number">3</span>)</span><br><span class="line">ReadFlag()</span><br></pre></td></tr></table></figure>

<p>就是两层lwe….. 直接当成lwe做就好了</p>
<h2 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h2><p>手动把远程给的向量和矩阵扔进下面的脚本里  把跑出来的向量传给服务器就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.modules.free_module_integer <span class="keyword">import</span> IntegerLattice</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BabaisClosestPlaneAlgorithm</span>(<span class="params">L, w</span>):</span></span><br><span class="line">    G, _ = L.gram_schmidt()</span><br><span class="line">    t = w</span><br><span class="line">    i = L.nrows() - <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> i &gt;= <span class="number">0</span>:</span><br><span class="line">        w -= <span class="built_in">round</span>( (w*G[i]) / G[i].norm()^<span class="number">2</span> ) * L[i]</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> t - w</span><br><span class="line"></span><br><span class="line">p = <span class="number">227</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M = Matrix([[<span class="number">55</span>,<span class="number">78</span>,<span class="number">211</span>,<span class="number">140</span>,<span class="number">203</span>,<span class="number">28</span>,<span class="number">205</span>,<span class="number">71</span>,<span class="number">148</span>,<span class="number">55</span>,<span class="number">43</span>,<span class="number">66</span>,<span class="number">34</span>,<span class="number">108</span>,<span class="number">99</span>,<span class="number">6</span>,<span class="number">202</span>,<span class="number">138</span>,<span class="number">90</span>,<span class="number">77</span>,<span class="number">128</span>,<span class="number">85</span>,<span class="number">88</span>,<span class="number">189</span>,<span class="number">135</span>,<span class="number">42</span>,<span class="number">157</span>,<span class="number">159</span>,<span class="number">204</span>,<span class="number">51</span>,<span class="number">211</span>,<span class="number">77</span>,<span class="number">2</span>,<span class="number">64</span>,<span class="number">60</span>,<span class="number">137</span>,<span class="number">53</span>,<span class="number">29</span>,<span class="number">214</span>,<span class="number">153</span>,<span class="number">142</span>,<span class="number">138</span>,<span class="number">0</span>,<span class="number">148</span>,<span class="number">53</span>,<span class="number">115</span>,<span class="number">73</span>,<span class="number">178</span>,<span class="number">78</span>,<span class="number">81</span>,<span class="number">219</span>,<span class="number">103</span>,<span class="number">23</span>,<span class="number">64</span>,<span class="number">146</span>,<span class="number">61</span>,<span class="number">98</span>,<span class="number">86</span>,<span class="number">157</span>,<span class="number">102</span>,<span class="number">222</span>,<span class="number">219</span>,<span class="number">2</span>,<span class="number">69</span>,<span class="number">65</span>,<span class="number">183</span>,<span class="number">93</span>,<span class="number">208</span>,<span class="number">156</span>,<span class="number">80</span>,<span class="number">164</span>,<span class="number">70</span>,<span class="number">200</span>,<span class="number">106</span>,<span class="number">128</span>,<span class="number">123</span>,<span class="number">1</span>,<span class="number">29</span>,<span class="number">175</span>,<span class="number">224</span>,<span class="number">62</span>,<span class="number">166</span>,<span class="number">62</span>,<span class="number">122</span>,<span class="number">102</span>,<span class="number">21</span>,<span class="number">3</span>,<span class="number">166</span>,<span class="number">41</span>,<span class="number">26</span>,<span class="number">164</span>,<span class="number">78</span>,<span class="number">199</span>,<span class="number">194</span>,<span class="number">56</span>,<span class="number">82</span>,<span class="number">6</span>,<span class="number">135</span>,<span class="number">99</span>,<span class="number">107</span>,<span class="number">104</span>,<span class="number">178</span>,<span class="number">32</span>,<span class="number">12</span>,<span class="number">57</span>,<span class="number">205</span>,<span class="number">63</span>,<span class="number">14</span>,<span class="number">159</span>,<span class="number">145</span>,<span class="number">133</span>,<span class="number">19</span>,<span class="number">96</span>,<span class="number">145</span>,<span class="number">20</span>,<span class="number">172</span>,<span class="number">49</span>,<span class="number">213</span>,<span class="number">200</span>,<span class="number">111</span>,<span class="number">148</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">6</span>,<span class="number">25</span>,<span class="number">19</span>,<span class="number">81</span>,<span class="number">199</span>,<span class="number">52</span>,<span class="number">119</span>,<span class="number">10</span>,<span class="number">12</span>,<span class="number">101</span>,<span class="number">140</span>,<span class="number">189</span>,<span class="number">61</span>,<span class="number">190</span>,<span class="number">168</span>,<span class="number">23</span>,<span class="number">181</span>,<span class="number">74</span>,<span class="number">153</span>,<span class="number">111</span>],[<span class="number">168</span>,<span class="number">115</span>,<span class="number">109</span>,<span class="number">184</span>,<span class="number">137</span>,<span class="number">28</span>,<span class="number">38</span>,<span class="number">86</span>,<span class="number">70</span>,<span class="number">99</span>,<span class="number">113</span>,<span class="number">24</span>,<span class="number">148</span>,<span class="number">189</span>,<span class="number">43</span>,<span class="number">211</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">139</span>,<span class="number">50</span>,<span class="number">120</span>,<span class="number">39</span>,<span class="number">192</span>,<span class="number">179</span>,<span class="number">92</span>,<span class="number">193</span>,<span class="number">96</span>,<span class="number">100</span>,<span class="number">124</span>,<span class="number">22</span>,<span class="number">214</span>,<span class="number">81</span>,<span class="number">216</span>,<span class="number">80</span>,<span class="number">55</span>,<span class="number">208</span>,<span class="number">184</span>,<span class="number">145</span>,<span class="number">132</span>,<span class="number">133</span>,<span class="number">177</span>,<span class="number">84</span>,<span class="number">64</span>,<span class="number">164</span>,<span class="number">121</span>,<span class="number">87</span>,<span class="number">191</span>,<span class="number">134</span>,<span class="number">38</span>,<span class="number">28</span>,<span class="number">2</span>,<span class="number">168</span>,<span class="number">66</span>,<span class="number">194</span>,<span class="number">117</span>,<span class="number">215</span>,<span class="number">83</span>,<span class="number">146</span>,<span class="number">217</span>,<span class="number">224</span>,<span class="number">54</span>,<span class="number">9</span>,<span class="number">188</span>,<span class="number">175</span>,<span class="number">39</span>,<span class="number">45</span>,<span class="number">18</span>,<span class="number">89</span>,<span class="number">68</span>,<span class="number">76</span>,<span class="number">20</span>,<span class="number">226</span>,<span class="number">155</span>,<span class="number">58</span>,<span class="number">70</span>,<span class="number">97</span>,<span class="number">209</span>,<span class="number">135</span>,<span class="number">210</span>,<span class="number">85</span>,<span class="number">108</span>,<span class="number">184</span>,<span class="number">7</span>,<span class="number">92</span>,<span class="number">226</span>,<span class="number">187</span>,<span class="number">205</span>,<span class="number">2</span>,<span class="number">88</span>,<span class="number">71</span>,<span class="number">92</span>,<span class="number">187</span>,<span class="number">186</span>,<span class="number">90</span>,<span class="number">182</span>,<span class="number">14</span>,<span class="number">58</span>,<span class="number">98</span>,<span class="number">32</span>,<span class="number">104</span>,<span class="number">141</span>,<span class="number">29</span>,<span class="number">131</span>,<span class="number">200</span>,<span class="number">85</span>,<span class="number">44</span>,<span class="number">30</span>,<span class="number">159</span>,<span class="number">4</span>,<span class="number">33</span>,<span class="number">113</span>,<span class="number">33</span>,<span class="number">49</span>,<span class="number">201</span>,<span class="number">54</span>,<span class="number">31</span>,<span class="number">158</span>,<span class="number">75</span>,<span class="number">225</span>,<span class="number">109</span>,<span class="number">30</span>,<span class="number">95</span>,<span class="number">142</span>,<span class="number">35</span>,<span class="number">204</span>,<span class="number">55</span>,<span class="number">203</span>,<span class="number">215</span>,<span class="number">156</span>,<span class="number">224</span>,<span class="number">2</span>,<span class="number">171</span>,<span class="number">87</span>,<span class="number">183</span>,<span class="number">175</span>,<span class="number">178</span>,<span class="number">168</span>,<span class="number">22</span>,<span class="number">24</span>,<span class="number">201</span>,<span class="number">28</span>,<span class="number">3</span>,<span class="number">20</span>],[<span class="number">152</span>,<span class="number">97</span>,<span class="number">15</span>,<span class="number">188</span>,<span class="number">52</span>,<span class="number">6</span>,<span class="number">149</span>,<span class="number">182</span>,<span class="number">167</span>,<span class="number">134</span>,<span class="number">60</span>,<span class="number">31</span>,<span class="number">154</span>,<span class="number">36</span>,<span class="number">6</span>,<span class="number">209</span>,<span class="number">28</span>,<span class="number">221</span>,<span class="number">144</span>,<span class="number">88</span>,<span class="number">161</span>,<span class="number">144</span>,<span class="number">13</span>,<span class="number">162</span>,<span class="number">90</span>,<span class="number">110</span>,<span class="number">95</span>,<span class="number">216</span>,<span class="number">196</span>,<span class="number">44</span>,<span class="number">133</span>,<span class="number">124</span>,<span class="number">75</span>,<span class="number">218</span>,<span class="number">170</span>,<span class="number">14</span>,<span class="number">84</span>,<span class="number">186</span>,<span class="number">127</span>,<span class="number">142</span>,<span class="number">59</span>,<span class="number">3</span>,<span class="number">185</span>,<span class="number">132</span>,<span class="number">147</span>,<span class="number">63</span>,<span class="number">121</span>,<span class="number">100</span>,<span class="number">10</span>,<span class="number">88</span>,<span class="number">103</span>,<span class="number">145</span>,<span class="number">3</span>,<span class="number">47</span>,<span class="number">179</span>,<span class="number">127</span>,<span class="number">127</span>,<span class="number">150</span>,<span class="number">133</span>,<span class="number">120</span>,<span class="number">90</span>,<span class="number">84</span>,<span class="number">186</span>,<span class="number">140</span>,<span class="number">21</span>,<span class="number">49</span>,<span class="number">93</span>,<span class="number">167</span>,<span class="number">70</span>,<span class="number">140</span>,<span class="number">161</span>,<span class="number">196</span>,<span class="number">29</span>,<span class="number">207</span>,<span class="number">128</span>,<span class="number">217</span>,<span class="number">125</span>,<span class="number">214</span>,<span class="number">28</span>,<span class="number">211</span>,<span class="number">66</span>,<span class="number">44</span>,<span class="number">33</span>,<span class="number">118</span>,<span class="number">166</span>,<span class="number">43</span>,<span class="number">220</span>,<span class="number">131</span>,<span class="number">26</span>,<span class="number">209</span>,<span class="number">108</span>,<span class="number">171</span>,<span class="number">41</span>,<span class="number">205</span>,<span class="number">163</span>,<span class="number">62</span>,<span class="number">20</span>,<span class="number">127</span>,<span class="number">184</span>,<span class="number">7</span>,<span class="number">95</span>,<span class="number">18</span>,<span class="number">125</span>,<span class="number">66</span>,<span class="number">94</span>,<span class="number">26</span>,<span class="number">33</span>,<span class="number">40</span>,<span class="number">68</span>,<span class="number">49</span>,<span class="number">197</span>,<span class="number">111</span>,<span class="number">46</span>,<span class="number">215</span>,<span class="number">97</span>,<span class="number">204</span>,<span class="number">98</span>,<span class="number">69</span>,<span class="number">206</span>,<span class="number">225</span>,<span class="number">193</span>,<span class="number">116</span>,<span class="number">43</span>,<span class="number">85</span>,<span class="number">153</span>,<span class="number">61</span>,<span class="number">184</span>,<span class="number">178</span>,<span class="number">195</span>,<span class="number">220</span>,<span class="number">127</span>,<span class="number">164</span>,<span class="number">168</span>,<span class="number">45</span>,<span class="number">42</span>,<span class="number">22</span>,<span class="number">104</span>,<span class="number">194</span>,<span class="number">19</span>,<span class="number">0</span>,<span class="number">111</span>,<span class="number">138</span>,<span class="number">191</span>],[<span class="number">54</span>,<span class="number">169</span>,<span class="number">0</span>,<span class="number">103</span>,<span class="number">88</span>,<span class="number">221</span>,<span class="number">86</span>,<span class="number">108</span>,<span class="number">36</span>,<span class="number">171</span>,<span class="number">128</span>,<span class="number">139</span>,<span class="number">198</span>,<span class="number">103</span>,<span class="number">154</span>,<span class="number">83</span>,<span class="number">193</span>,<span class="number">115</span>,<span class="number">84</span>,<span class="number">41</span>,<span class="number">84</span>,<span class="number">136</span>,<span class="number">75</span>,<span class="number">90</span>,<span class="number">20</span>,<span class="number">109</span>,<span class="number">219</span>,<span class="number">22</span>,<span class="number">107</span>,<span class="number">180</span>,<span class="number">136</span>,<span class="number">13</span>,<span class="number">203</span>,<span class="number">98</span>,<span class="number">133</span>,<span class="number">141</span>,<span class="number">57</span>,<span class="number">181</span>,<span class="number">139</span>,<span class="number">226</span>,<span class="number">161</span>,<span class="number">25</span>,<span class="number">21</span>,<span class="number">198</span>,<span class="number">3</span>,<span class="number">200</span>,<span class="number">17</span>,<span class="number">63</span>,<span class="number">223</span>,<span class="number">165</span>,<span class="number">54</span>,<span class="number">74</span>,<span class="number">76</span>,<span class="number">84</span>,<span class="number">189</span>,<span class="number">89</span>,<span class="number">84</span>,<span class="number">95</span>,<span class="number">191</span>,<span class="number">168</span>,<span class="number">91</span>,<span class="number">141</span>,<span class="number">109</span>,<span class="number">148</span>,<span class="number">186</span>,<span class="number">40</span>,<span class="number">5</span>,<span class="number">113</span>,<span class="number">0</span>,<span class="number">71</span>,<span class="number">167</span>,<span class="number">54</span>,<span class="number">29</span>,<span class="number">219</span>,<span class="number">55</span>,<span class="number">64</span>,<span class="number">3</span>,<span class="number">162</span>,<span class="number">34</span>,<span class="number">56</span>,<span class="number">138</span>,<span class="number">109</span>,<span class="number">65</span>,<span class="number">174</span>,<span class="number">43</span>,<span class="number">20</span>,<span class="number">158</span>,<span class="number">22</span>,<span class="number">175</span>,<span class="number">93</span>,<span class="number">136</span>,<span class="number">26</span>,<span class="number">193</span>,<span class="number">60</span>,<span class="number">180</span>,<span class="number">216</span>,<span class="number">24</span>,<span class="number">185</span>,<span class="number">56</span>,<span class="number">86</span>,<span class="number">205</span>,<span class="number">123</span>,<span class="number">31</span>,<span class="number">126</span>,<span class="number">120</span>,<span class="number">84</span>,<span class="number">47</span>,<span class="number">67</span>,<span class="number">165</span>,<span class="number">36</span>,<span class="number">217</span>,<span class="number">153</span>,<span class="number">192</span>,<span class="number">121</span>,<span class="number">142</span>,<span class="number">120</span>,<span class="number">153</span>,<span class="number">39</span>,<span class="number">188</span>,<span class="number">209</span>,<span class="number">119</span>,<span class="number">35</span>,<span class="number">223</span>,<span class="number">155</span>,<span class="number">49</span>,<span class="number">200</span>,<span class="number">215</span>,<span class="number">187</span>,<span class="number">10</span>,<span class="number">111</span>,<span class="number">138</span>,<span class="number">116</span>,<span class="number">223</span>,<span class="number">49</span>,<span class="number">14</span>,<span class="number">127</span>,<span class="number">100</span>,<span class="number">61</span>,<span class="number">197</span>,<span class="number">134</span>,<span class="number">143</span>,<span class="number">164</span>,<span class="number">192</span>],[<span class="number">125</span>,<span class="number">88</span>,<span class="number">118</span>,<span class="number">197</span>,<span class="number">140</span>,<span class="number">200</span>,<span class="number">191</span>,<span class="number">110</span>,<span class="number">135</span>,<span class="number">76</span>,<span class="number">71</span>,<span class="number">33</span>,<span class="number">223</span>,<span class="number">183</span>,<span class="number">34</span>,<span class="number">100</span>,<span class="number">16</span>,<span class="number">53</span>,<span class="number">190</span>,<span class="number">153</span>,<span class="number">185</span>,<span class="number">201</span>,<span class="number">91</span>,<span class="number">118</span>,<span class="number">118</span>,<span class="number">51</span>,<span class="number">10</span>,<span class="number">214</span>,<span class="number">142</span>,<span class="number">223</span>,<span class="number">77</span>,<span class="number">215</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">109</span>,<span class="number">166</span>,<span class="number">210</span>,<span class="number">32</span>,<span class="number">63</span>,<span class="number">129</span>,<span class="number">109</span>,<span class="number">146</span>,<span class="number">9</span>,<span class="number">68</span>,<span class="number">28</span>,<span class="number">224</span>,<span class="number">73</span>,<span class="number">43</span>,<span class="number">159</span>,<span class="number">35</span>,<span class="number">185</span>,<span class="number">100</span>,<span class="number">126</span>,<span class="number">218</span>,<span class="number">88</span>,<span class="number">90</span>,<span class="number">111</span>,<span class="number">79</span>,<span class="number">177</span>,<span class="number">54</span>,<span class="number">149</span>,<span class="number">31</span>,<span class="number">86</span>,<span class="number">82</span>,<span class="number">203</span>,<span class="number">11</span>,<span class="number">104</span>,<span class="number">211</span>,<span class="number">200</span>,<span class="number">205</span>,<span class="number">75</span>,<span class="number">226</span>,<span class="number">220</span>,<span class="number">36</span>,<span class="number">31</span>,<span class="number">177</span>,<span class="number">191</span>,<span class="number">200</span>,<span class="number">210</span>,<span class="number">92</span>,<span class="number">60</span>,<span class="number">92</span>,<span class="number">40</span>,<span class="number">96</span>,<span class="number">23</span>,<span class="number">129</span>,<span class="number">99</span>,<span class="number">209</span>,<span class="number">57</span>,<span class="number">55</span>,<span class="number">224</span>,<span class="number">12</span>,<span class="number">154</span>,<span class="number">200</span>,<span class="number">118</span>,<span class="number">25</span>,<span class="number">168</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">93</span>,<span class="number">91</span>,<span class="number">175</span>,<span class="number">107</span>,<span class="number">35</span>,<span class="number">22</span>,<span class="number">123</span>,<span class="number">110</span>,<span class="number">86</span>,<span class="number">87</span>,<span class="number">62</span>,<span class="number">149</span>,<span class="number">79</span>,<span class="number">116</span>,<span class="number">28</span>,<span class="number">125</span>,<span class="number">164</span>,<span class="number">114</span>,<span class="number">88</span>,<span class="number">217</span>,<span class="number">80</span>,<span class="number">199</span>,<span class="number">211</span>,<span class="number">113</span>,<span class="number">20</span>,<span class="number">29</span>,<span class="number">68</span>,<span class="number">124</span>,<span class="number">141</span>,<span class="number">157</span>,<span class="number">11</span>,<span class="number">160</span>,<span class="number">85</span>,<span class="number">189</span>,<span class="number">223</span>,<span class="number">135</span>,<span class="number">77</span>,<span class="number">186</span>,<span class="number">172</span>,<span class="number">11</span>,<span class="number">55</span>,<span class="number">40</span>,<span class="number">125</span>,<span class="number">187</span>],[<span class="number">32</span>,<span class="number">42</span>,<span class="number">151</span>,<span class="number">123</span>,<span class="number">149</span>,<span class="number">215</span>,<span class="number">156</span>,<span class="number">87</span>,<span class="number">47</span>,<span class="number">27</span>,<span class="number">160</span>,<span class="number">145</span>,<span class="number">114</span>,<span class="number">118</span>,<span class="number">78</span>,<span class="number">113</span>,<span class="number">205</span>,<span class="number">152</span>,<span class="number">173</span>,<span class="number">92</span>,<span class="number">109</span>,<span class="number">62</span>,<span class="number">185</span>,<span class="number">201</span>,<span class="number">149</span>,<span class="number">216</span>,<span class="number">220</span>,<span class="number">72</span>,<span class="number">208</span>,<span class="number">55</span>,<span class="number">78</span>,<span class="number">1</span>,<span class="number">56</span>,<span class="number">177</span>,<span class="number">147</span>,<span class="number">30</span>,<span class="number">68</span>,<span class="number">223</span>,<span class="number">194</span>,<span class="number">126</span>,<span class="number">155</span>,<span class="number">59</span>,<span class="number">24</span>,<span class="number">10</span>,<span class="number">26</span>,<span class="number">8</span>,<span class="number">104</span>,<span class="number">211</span>,<span class="number">214</span>,<span class="number">119</span>,<span class="number">208</span>,<span class="number">141</span>,<span class="number">188</span>,<span class="number">65</span>,<span class="number">82</span>,<span class="number">130</span>,<span class="number">173</span>,<span class="number">190</span>,<span class="number">107</span>,<span class="number">156</span>,<span class="number">57</span>,<span class="number">157</span>,<span class="number">16</span>,<span class="number">72</span>,<span class="number">43</span>,<span class="number">154</span>,<span class="number">174</span>,<span class="number">52</span>,<span class="number">7</span>,<span class="number">22</span>,<span class="number">39</span>,<span class="number">163</span>,<span class="number">219</span>,<span class="number">134</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">20</span>,<span class="number">75</span>,<span class="number">189</span>,<span class="number">182</span>,<span class="number">161</span>,<span class="number">32</span>,<span class="number">82</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">22</span>,<span class="number">46</span>,<span class="number">33</span>,<span class="number">145</span>,<span class="number">120</span>,<span class="number">161</span>,<span class="number">216</span>,<span class="number">6</span>,<span class="number">185</span>,<span class="number">131</span>,<span class="number">226</span>,<span class="number">56</span>,<span class="number">53</span>,<span class="number">219</span>,<span class="number">173</span>,<span class="number">150</span>,<span class="number">94</span>,<span class="number">93</span>,<span class="number">10</span>,<span class="number">64</span>,<span class="number">99</span>,<span class="number">124</span>,<span class="number">195</span>,<span class="number">207</span>,<span class="number">220</span>,<span class="number">96</span>,<span class="number">80</span>,<span class="number">207</span>,<span class="number">155</span>,<span class="number">193</span>,<span class="number">223</span>,<span class="number">68</span>,<span class="number">166</span>,<span class="number">99</span>,<span class="number">189</span>,<span class="number">67</span>,<span class="number">78</span>,<span class="number">222</span>,<span class="number">15</span>,<span class="number">76</span>,<span class="number">35</span>,<span class="number">206</span>,<span class="number">19</span>,<span class="number">114</span>,<span class="number">149</span>,<span class="number">1</span>,<span class="number">141</span>,<span class="number">63</span>,<span class="number">20</span>,<span class="number">145</span>,<span class="number">56</span>,<span class="number">214</span>,<span class="number">212</span>,<span class="number">44</span>,<span class="number">186</span>,<span class="number">88</span>,<span class="number">141</span>,<span class="number">204</span>],[<span class="number">114</span>,<span class="number">4</span>,<span class="number">210</span>,<span class="number">127</span>,<span class="number">90</span>,<span class="number">181</span>,<span class="number">97</span>,<span class="number">17</span>,<span class="number">51</span>,<span class="number">156</span>,<span class="number">182</span>,<span class="number">58</span>,<span class="number">167</span>,<span class="number">185</span>,<span class="number">111</span>,<span class="number">54</span>,<span class="number">67</span>,<span class="number">137</span>,<span class="number">213</span>,<span class="number">165</span>,<span class="number">219</span>,<span class="number">211</span>,<span class="number">143</span>,<span class="number">4</span>,<span class="number">65</span>,<span class="number">129</span>,<span class="number">91</span>,<span class="number">190</span>,<span class="number">67</span>,<span class="number">180</span>,<span class="number">163</span>,<span class="number">29</span>,<span class="number">221</span>,<span class="number">185</span>,<span class="number">100</span>,<span class="number">225</span>,<span class="number">103</span>,<span class="number">190</span>,<span class="number">133</span>,<span class="number">208</span>,<span class="number">90</span>,<span class="number">11</span>,<span class="number">123</span>,<span class="number">141</span>,<span class="number">174</span>,<span class="number">93</span>,<span class="number">18</span>,<span class="number">177</span>,<span class="number">124</span>,<span class="number">146</span>,<span class="number">50</span>,<span class="number">107</span>,<span class="number">25</span>,<span class="number">64</span>,<span class="number">219</span>,<span class="number">63</span>,<span class="number">44</span>,<span class="number">186</span>,<span class="number">152</span>,<span class="number">14</span>,<span class="number">25</span>,<span class="number">141</span>,<span class="number">107</span>,<span class="number">188</span>,<span class="number">106</span>,<span class="number">168</span>,<span class="number">136</span>,<span class="number">94</span>,<span class="number">154</span>,<span class="number">6</span>,<span class="number">41</span>,<span class="number">168</span>,<span class="number">193</span>,<span class="number">137</span>,<span class="number">92</span>,<span class="number">179</span>,<span class="number">203</span>,<span class="number">36</span>,<span class="number">85</span>,<span class="number">213</span>,<span class="number">138</span>,<span class="number">149</span>,<span class="number">225</span>,<span class="number">62</span>,<span class="number">89</span>,<span class="number">78</span>,<span class="number">10</span>,<span class="number">180</span>,<span class="number">25</span>,<span class="number">155</span>,<span class="number">38</span>,<span class="number">223</span>,<span class="number">82</span>,<span class="number">221</span>,<span class="number">190</span>,<span class="number">223</span>,<span class="number">42</span>,<span class="number">144</span>,<span class="number">186</span>,<span class="number">49</span>,<span class="number">169</span>,<span class="number">45</span>,<span class="number">161</span>,<span class="number">137</span>,<span class="number">152</span>,<span class="number">180</span>,<span class="number">152</span>,<span class="number">77</span>,<span class="number">97</span>,<span class="number">222</span>,<span class="number">104</span>,<span class="number">98</span>,<span class="number">167</span>,<span class="number">88</span>,<span class="number">116</span>,<span class="number">174</span>,<span class="number">67</span>,<span class="number">75</span>,<span class="number">81</span>,<span class="number">119</span>,<span class="number">205</span>,<span class="number">3</span>,<span class="number">180</span>,<span class="number">24</span>,<span class="number">159</span>,<span class="number">190</span>,<span class="number">102</span>,<span class="number">157</span>,<span class="number">199</span>,<span class="number">152</span>,<span class="number">145</span>,<span class="number">146</span>,<span class="number">131</span>,<span class="number">208</span>,<span class="number">58</span>,<span class="number">121</span>,<span class="number">178</span>,<span class="number">95</span>,<span class="number">211</span>,<span class="number">214</span>,<span class="number">163</span>,<span class="number">196</span>,<span class="number">104</span>],[<span class="number">32</span>,<span class="number">174</span>,<span class="number">189</span>,<span class="number">30</span>,<span class="number">141</span>,<span class="number">182</span>,<span class="number">192</span>,<span class="number">20</span>,<span class="number">103</span>,<span class="number">100</span>,<span class="number">191</span>,<span class="number">80</span>,<span class="number">151</span>,<span class="number">124</span>,<span class="number">185</span>,<span class="number">166</span>,<span class="number">41</span>,<span class="number">32</span>,<span class="number">39</span>,<span class="number">34</span>,<span class="number">169</span>,<span class="number">35</span>,<span class="number">80</span>,<span class="number">108</span>,<span class="number">89</span>,<span class="number">67</span>,<span class="number">150</span>,<span class="number">16</span>,<span class="number">109</span>,<span class="number">8</span>,<span class="number">102</span>,<span class="number">122</span>,<span class="number">85</span>,<span class="number">224</span>,<span class="number">175</span>,<span class="number">115</span>,<span class="number">104</span>,<span class="number">20</span>,<span class="number">116</span>,<span class="number">112</span>,<span class="number">192</span>,<span class="number">66</span>,<span class="number">173</span>,<span class="number">212</span>,<span class="number">29</span>,<span class="number">19</span>,<span class="number">102</span>,<span class="number">66</span>,<span class="number">116</span>,<span class="number">37</span>,<span class="number">146</span>,<span class="number">19</span>,<span class="number">102</span>,<span class="number">65</span>,<span class="number">98</span>,<span class="number">187</span>,<span class="number">0</span>,<span class="number">142</span>,<span class="number">56</span>,<span class="number">192</span>,<span class="number">143</span>,<span class="number">91</span>,<span class="number">20</span>,<span class="number">193</span>,<span class="number">183</span>,<span class="number">107</span>,<span class="number">215</span>,<span class="number">144</span>,<span class="number">184</span>,<span class="number">57</span>,<span class="number">193</span>,<span class="number">86</span>,<span class="number">50</span>,<span class="number">65</span>,<span class="number">220</span>,<span class="number">129</span>,<span class="number">51</span>,<span class="number">212</span>,<span class="number">78</span>,<span class="number">16</span>,<span class="number">91</span>,<span class="number">190</span>,<span class="number">37</span>,<span class="number">116</span>,<span class="number">102</span>,<span class="number">120</span>,<span class="number">178</span>,<span class="number">56</span>,<span class="number">193</span>,<span class="number">146</span>,<span class="number">218</span>,<span class="number">64</span>,<span class="number">142</span>,<span class="number">178</span>,<span class="number">225</span>,<span class="number">207</span>,<span class="number">129</span>,<span class="number">110</span>,<span class="number">104</span>,<span class="number">170</span>,<span class="number">156</span>,<span class="number">148</span>,<span class="number">182</span>,<span class="number">91</span>,<span class="number">220</span>,<span class="number">207</span>,<span class="number">193</span>,<span class="number">124</span>,<span class="number">45</span>,<span class="number">98</span>,<span class="number">57</span>,<span class="number">96</span>,<span class="number">38</span>,<span class="number">67</span>,<span class="number">99</span>,<span class="number">97</span>,<span class="number">149</span>,<span class="number">7</span>,<span class="number">181</span>,<span class="number">138</span>,<span class="number">192</span>,<span class="number">220</span>,<span class="number">195</span>,<span class="number">14</span>,<span class="number">99</span>,<span class="number">152</span>,<span class="number">38</span>,<span class="number">70</span>,<span class="number">186</span>,<span class="number">8</span>,<span class="number">123</span>,<span class="number">204</span>,<span class="number">127</span>,<span class="number">1</span>,<span class="number">39</span>,<span class="number">181</span>,<span class="number">159</span>,<span class="number">75</span>,<span class="number">122</span>,<span class="number">54</span>,<span class="number">41</span>,<span class="number">137</span>,<span class="number">41</span>],[<span class="number">115</span>,<span class="number">170</span>,<span class="number">6</span>,<span class="number">225</span>,<span class="number">99</span>,<span class="number">21</span>,<span class="number">139</span>,<span class="number">118</span>,<span class="number">133</span>,<span class="number">16</span>,<span class="number">175</span>,<span class="number">94</span>,<span class="number">163</span>,<span class="number">163</span>,<span class="number">222</span>,<span class="number">67</span>,<span class="number">220</span>,<span class="number">75</span>,<span class="number">215</span>,<span class="number">142</span>,<span class="number">8</span>,<span class="number">167</span>,<span class="number">86</span>,<span class="number">20</span>,<span class="number">94</span>,<span class="number">7</span>,<span class="number">169</span>,<span class="number">5</span>,<span class="number">145</span>,<span class="number">208</span>,<span class="number">213</span>,<span class="number">153</span>,<span class="number">38</span>,<span class="number">202</span>,<span class="number">191</span>,<span class="number">10</span>,<span class="number">66</span>,<span class="number">133</span>,<span class="number">92</span>,<span class="number">91</span>,<span class="number">95</span>,<span class="number">28</span>,<span class="number">38</span>,<span class="number">86</span>,<span class="number">127</span>,<span class="number">215</span>,<span class="number">3</span>,<span class="number">206</span>,<span class="number">67</span>,<span class="number">170</span>,<span class="number">14</span>,<span class="number">153</span>,<span class="number">108</span>,<span class="number">219</span>,<span class="number">0</span>,<span class="number">10</span>,<span class="number">64</span>,<span class="number">78</span>,<span class="number">74</span>,<span class="number">223</span>,<span class="number">199</span>,<span class="number">180</span>,<span class="number">16</span>,<span class="number">13</span>,<span class="number">169</span>,<span class="number">109</span>,<span class="number">224</span>,<span class="number">213</span>,<span class="number">142</span>,<span class="number">65</span>,<span class="number">12</span>,<span class="number">29</span>,<span class="number">100</span>,<span class="number">109</span>,<span class="number">104</span>,<span class="number">102</span>,<span class="number">131</span>,<span class="number">24</span>,<span class="number">202</span>,<span class="number">92</span>,<span class="number">70</span>,<span class="number">11</span>,<span class="number">215</span>,<span class="number">41</span>,<span class="number">35</span>,<span class="number">112</span>,<span class="number">39</span>,<span class="number">10</span>,<span class="number">182</span>,<span class="number">131</span>,<span class="number">120</span>,<span class="number">95</span>,<span class="number">112</span>,<span class="number">49</span>,<span class="number">116</span>,<span class="number">81</span>,<span class="number">43</span>,<span class="number">49</span>,<span class="number">54</span>,<span class="number">30</span>,<span class="number">225</span>,<span class="number">63</span>,<span class="number">167</span>,<span class="number">16</span>,<span class="number">118</span>,<span class="number">75</span>,<span class="number">193</span>,<span class="number">50</span>,<span class="number">125</span>,<span class="number">224</span>,<span class="number">161</span>,<span class="number">127</span>,<span class="number">186</span>,<span class="number">88</span>,<span class="number">196</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">215</span>,<span class="number">219</span>,<span class="number">217</span>,<span class="number">168</span>,<span class="number">221</span>,<span class="number">206</span>,<span class="number">63</span>,<span class="number">86</span>,<span class="number">133</span>,<span class="number">153</span>,<span class="number">216</span>,<span class="number">16</span>,<span class="number">152</span>,<span class="number">39</span>,<span class="number">19</span>,<span class="number">183</span>,<span class="number">155</span>,<span class="number">200</span>,<span class="number">80</span>,<span class="number">33</span>,<span class="number">48</span>,<span class="number">150</span>,<span class="number">104</span>,<span class="number">193</span>,<span class="number">137</span>,<span class="number">189</span>],[<span class="number">19</span>,<span class="number">127</span>,<span class="number">92</span>,<span class="number">102</span>,<span class="number">59</span>,<span class="number">196</span>,<span class="number">66</span>,<span class="number">49</span>,<span class="number">7</span>,<span class="number">211</span>,<span class="number">120</span>,<span class="number">87</span>,<span class="number">95</span>,<span class="number">196</span>,<span class="number">93</span>,<span class="number">17</span>,<span class="number">195</span>,<span class="number">184</span>,<span class="number">187</span>,<span class="number">87</span>,<span class="number">0</span>,<span class="number">151</span>,<span class="number">169</span>,<span class="number">150</span>,<span class="number">82</span>,<span class="number">67</span>,<span class="number">24</span>,<span class="number">85</span>,<span class="number">12</span>,<span class="number">77</span>,<span class="number">20</span>,<span class="number">10</span>,<span class="number">211</span>,<span class="number">203</span>,<span class="number">57</span>,<span class="number">181</span>,<span class="number">156</span>,<span class="number">148</span>,<span class="number">195</span>,<span class="number">123</span>,<span class="number">90</span>,<span class="number">135</span>,<span class="number">14</span>,<span class="number">200</span>,<span class="number">226</span>,<span class="number">135</span>,<span class="number">17</span>,<span class="number">208</span>,<span class="number">15</span>,<span class="number">176</span>,<span class="number">168</span>,<span class="number">140</span>,<span class="number">161</span>,<span class="number">217</span>,<span class="number">2</span>,<span class="number">125</span>,<span class="number">91</span>,<span class="number">167</span>,<span class="number">157</span>,<span class="number">118</span>,<span class="number">100</span>,<span class="number">167</span>,<span class="number">148</span>,<span class="number">155</span>,<span class="number">114</span>,<span class="number">208</span>,<span class="number">159</span>,<span class="number">123</span>,<span class="number">136</span>,<span class="number">95</span>,<span class="number">89</span>,<span class="number">170</span>,<span class="number">21</span>,<span class="number">130</span>,<span class="number">82</span>,<span class="number">10</span>,<span class="number">47</span>,<span class="number">136</span>,<span class="number">88</span>,<span class="number">45</span>,<span class="number">224</span>,<span class="number">23</span>,<span class="number">55</span>,<span class="number">207</span>,<span class="number">200</span>,<span class="number">124</span>,<span class="number">123</span>,<span class="number">113</span>,<span class="number">105</span>,<span class="number">67</span>,<span class="number">80</span>,<span class="number">147</span>,<span class="number">55</span>,<span class="number">127</span>,<span class="number">200</span>,<span class="number">158</span>,<span class="number">209</span>,<span class="number">10</span>,<span class="number">53</span>,<span class="number">135</span>,<span class="number">100</span>,<span class="number">161</span>,<span class="number">27</span>,<span class="number">154</span>,<span class="number">2</span>,<span class="number">80</span>,<span class="number">174</span>,<span class="number">95</span>,<span class="number">12</span>,<span class="number">73</span>,<span class="number">154</span>,<span class="number">17</span>,<span class="number">92</span>,<span class="number">106</span>,<span class="number">206</span>,<span class="number">85</span>,<span class="number">171</span>,<span class="number">69</span>,<span class="number">56</span>,<span class="number">212</span>,<span class="number">213</span>,<span class="number">211</span>,<span class="number">221</span>,<span class="number">166</span>,<span class="number">72</span>,<span class="number">188</span>,<span class="number">78</span>,<span class="number">113</span>,<span class="number">147</span>,<span class="number">26</span>,<span class="number">148</span>,<span class="number">141</span>,<span class="number">41</span>,<span class="number">96</span>,<span class="number">81</span>,<span class="number">31</span>,<span class="number">95</span>,<span class="number">169</span>,<span class="number">164</span>,<span class="number">7</span>,<span class="number">134</span>,<span class="number">125</span>,<span class="number">174</span>],[<span class="number">158</span>,<span class="number">177</span>,<span class="number">225</span>,<span class="number">122</span>,<span class="number">164</span>,<span class="number">132</span>,<span class="number">16</span>,<span class="number">150</span>,<span class="number">170</span>,<span class="number">166</span>,<span class="number">67</span>,<span class="number">2</span>,<span class="number">192</span>,<span class="number">194</span>,<span class="number">28</span>,<span class="number">104</span>,<span class="number">59</span>,<span class="number">148</span>,<span class="number">150</span>,<span class="number">106</span>,<span class="number">179</span>,<span class="number">217</span>,<span class="number">159</span>,<span class="number">94</span>,<span class="number">107</span>,<span class="number">217</span>,<span class="number">209</span>,<span class="number">225</span>,<span class="number">226</span>,<span class="number">39</span>,<span class="number">138</span>,<span class="number">219</span>,<span class="number">163</span>,<span class="number">116</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">63</span>,<span class="number">140</span>,<span class="number">8</span>,<span class="number">139</span>,<span class="number">38</span>,<span class="number">144</span>,<span class="number">63</span>,<span class="number">94</span>,<span class="number">205</span>,<span class="number">210</span>,<span class="number">186</span>,<span class="number">217</span>,<span class="number">214</span>,<span class="number">141</span>,<span class="number">22</span>,<span class="number">186</span>,<span class="number">198</span>,<span class="number">114</span>,<span class="number">211</span>,<span class="number">219</span>,<span class="number">82</span>,<span class="number">34</span>,<span class="number">122</span>,<span class="number">92</span>,<span class="number">34</span>,<span class="number">182</span>,<span class="number">156</span>,<span class="number">170</span>,<span class="number">58</span>,<span class="number">41</span>,<span class="number">150</span>,<span class="number">36</span>,<span class="number">212</span>,<span class="number">197</span>,<span class="number">38</span>,<span class="number">131</span>,<span class="number">28</span>,<span class="number">110</span>,<span class="number">48</span>,<span class="number">224</span>,<span class="number">19</span>,<span class="number">109</span>,<span class="number">185</span>,<span class="number">142</span>,<span class="number">186</span>,<span class="number">14</span>,<span class="number">126</span>,<span class="number">156</span>,<span class="number">105</span>,<span class="number">33</span>,<span class="number">79</span>,<span class="number">93</span>,<span class="number">162</span>,<span class="number">183</span>,<span class="number">156</span>,<span class="number">135</span>,<span class="number">43</span>,<span class="number">144</span>,<span class="number">114</span>,<span class="number">8</span>,<span class="number">158</span>,<span class="number">102</span>,<span class="number">145</span>,<span class="number">194</span>,<span class="number">26</span>,<span class="number">29</span>,<span class="number">183</span>,<span class="number">205</span>,<span class="number">219</span>,<span class="number">196</span>,<span class="number">207</span>,<span class="number">142</span>,<span class="number">176</span>,<span class="number">21</span>,<span class="number">225</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">22</span>,<span class="number">176</span>,<span class="number">100</span>,<span class="number">40</span>,<span class="number">125</span>,<span class="number">120</span>,<span class="number">114</span>,<span class="number">74</span>,<span class="number">34</span>,<span class="number">176</span>,<span class="number">98</span>,<span class="number">121</span>,<span class="number">77</span>,<span class="number">116</span>,<span class="number">200</span>,<span class="number">85</span>,<span class="number">96</span>,<span class="number">167</span>,<span class="number">63</span>,<span class="number">215</span>,<span class="number">80</span>,<span class="number">1</span>,<span class="number">218</span>,<span class="number">94</span>,<span class="number">29</span>,<span class="number">65</span>,<span class="number">202</span>,<span class="number">42</span>,<span class="number">45</span>,<span class="number">114</span>],[<span class="number">130</span>,<span class="number">124</span>,<span class="number">40</span>,<span class="number">71</span>,<span class="number">145</span>,<span class="number">69</span>,<span class="number">216</span>,<span class="number">122</span>,<span class="number">162</span>,<span class="number">57</span>,<span class="number">134</span>,<span class="number">79</span>,<span class="number">103</span>,<span class="number">8</span>,<span class="number">137</span>,<span class="number">110</span>,<span class="number">8</span>,<span class="number">103</span>,<span class="number">216</span>,<span class="number">172</span>,<span class="number">74</span>,<span class="number">219</span>,<span class="number">141</span>,<span class="number">99</span>,<span class="number">78</span>,<span class="number">104</span>,<span class="number">143</span>,<span class="number">110</span>,<span class="number">130</span>,<span class="number">49</span>,<span class="number">45</span>,<span class="number">54</span>,<span class="number">160</span>,<span class="number">15</span>,<span class="number">196</span>,<span class="number">67</span>,<span class="number">109</span>,<span class="number">208</span>,<span class="number">30</span>,<span class="number">21</span>,<span class="number">195</span>,<span class="number">46</span>,<span class="number">91</span>,<span class="number">38</span>,<span class="number">52</span>,<span class="number">115</span>,<span class="number">173</span>,<span class="number">77</span>,<span class="number">87</span>,<span class="number">111</span>,<span class="number">215</span>,<span class="number">100</span>,<span class="number">91</span>,<span class="number">220</span>,<span class="number">21</span>,<span class="number">4</span>,<span class="number">34</span>,<span class="number">203</span>,<span class="number">173</span>,<span class="number">9</span>,<span class="number">171</span>,<span class="number">129</span>,<span class="number">170</span>,<span class="number">202</span>,<span class="number">9</span>,<span class="number">185</span>,<span class="number">47</span>,<span class="number">198</span>,<span class="number">141</span>,<span class="number">90</span>,<span class="number">216</span>,<span class="number">156</span>,<span class="number">215</span>,<span class="number">99</span>,<span class="number">99</span>,<span class="number">185</span>,<span class="number">194</span>,<span class="number">217</span>,<span class="number">171</span>,<span class="number">155</span>,<span class="number">189</span>,<span class="number">54</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">162</span>,<span class="number">173</span>,<span class="number">58</span>,<span class="number">79</span>,<span class="number">34</span>,<span class="number">103</span>,<span class="number">137</span>,<span class="number">208</span>,<span class="number">62</span>,<span class="number">165</span>,<span class="number">104</span>,<span class="number">143</span>,<span class="number">80</span>,<span class="number">33</span>,<span class="number">136</span>,<span class="number">39</span>,<span class="number">111</span>,<span class="number">176</span>,<span class="number">202</span>,<span class="number">207</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">173</span>,<span class="number">139</span>,<span class="number">50</span>,<span class="number">49</span>,<span class="number">9</span>,<span class="number">165</span>,<span class="number">170</span>,<span class="number">78</span>,<span class="number">154</span>,<span class="number">180</span>,<span class="number">45</span>,<span class="number">153</span>,<span class="number">40</span>,<span class="number">157</span>,<span class="number">94</span>,<span class="number">73</span>,<span class="number">86</span>,<span class="number">207</span>,<span class="number">26</span>,<span class="number">199</span>,<span class="number">152</span>,<span class="number">12</span>,<span class="number">62</span>,<span class="number">192</span>,<span class="number">175</span>,<span class="number">60</span>,<span class="number">136</span>,<span class="number">96</span>,<span class="number">31</span>,<span class="number">171</span>,<span class="number">114</span>,<span class="number">8</span>,<span class="number">95</span>,<span class="number">17</span>,<span class="number">87</span>,<span class="number">39</span>,<span class="number">177</span>],[<span class="number">51</span>,<span class="number">36</span>,<span class="number">34</span>,<span class="number">69</span>,<span class="number">152</span>,<span class="number">211</span>,<span class="number">6</span>,<span class="number">89</span>,<span class="number">157</span>,<span class="number">60</span>,<span class="number">65</span>,<span class="number">58</span>,<span class="number">78</span>,<span class="number">22</span>,<span class="number">92</span>,<span class="number">23</span>,<span class="number">172</span>,<span class="number">105</span>,<span class="number">12</span>,<span class="number">218</span>,<span class="number">154</span>,<span class="number">171</span>,<span class="number">96</span>,<span class="number">201</span>,<span class="number">41</span>,<span class="number">53</span>,<span class="number">204</span>,<span class="number">215</span>,<span class="number">23</span>,<span class="number">211</span>,<span class="number">216</span>,<span class="number">98</span>,<span class="number">80</span>,<span class="number">45</span>,<span class="number">90</span>,<span class="number">27</span>,<span class="number">177</span>,<span class="number">9</span>,<span class="number">74</span>,<span class="number">169</span>,<span class="number">23</span>,<span class="number">197</span>,<span class="number">221</span>,<span class="number">74</span>,<span class="number">119</span>,<span class="number">152</span>,<span class="number">158</span>,<span class="number">180</span>,<span class="number">73</span>,<span class="number">138</span>,<span class="number">192</span>,<span class="number">149</span>,<span class="number">37</span>,<span class="number">147</span>,<span class="number">80</span>,<span class="number">26</span>,<span class="number">154</span>,<span class="number">180</span>,<span class="number">97</span>,<span class="number">208</span>,<span class="number">130</span>,<span class="number">165</span>,<span class="number">41</span>,<span class="number">180</span>,<span class="number">176</span>,<span class="number">160</span>,<span class="number">20</span>,<span class="number">155</span>,<span class="number">149</span>,<span class="number">213</span>,<span class="number">181</span>,<span class="number">81</span>,<span class="number">62</span>,<span class="number">173</span>,<span class="number">108</span>,<span class="number">80</span>,<span class="number">86</span>,<span class="number">182</span>,<span class="number">35</span>,<span class="number">209</span>,<span class="number">190</span>,<span class="number">217</span>,<span class="number">187</span>,<span class="number">180</span>,<span class="number">201</span>,<span class="number">225</span>,<span class="number">112</span>,<span class="number">125</span>,<span class="number">95</span>,<span class="number">118</span>,<span class="number">48</span>,<span class="number">137</span>,<span class="number">96</span>,<span class="number">79</span>,<span class="number">127</span>,<span class="number">206</span>,<span class="number">49</span>,<span class="number">85</span>,<span class="number">143</span>,<span class="number">139</span>,<span class="number">200</span>,<span class="number">194</span>,<span class="number">49</span>,<span class="number">6</span>,<span class="number">208</span>,<span class="number">109</span>,<span class="number">5</span>,<span class="number">197</span>,<span class="number">75</span>,<span class="number">150</span>,<span class="number">134</span>,<span class="number">194</span>,<span class="number">0</span>,<span class="number">191</span>,<span class="number">72</span>,<span class="number">16</span>,<span class="number">101</span>,<span class="number">4</span>,<span class="number">85</span>,<span class="number">178</span>,<span class="number">131</span>,<span class="number">52</span>,<span class="number">94</span>,<span class="number">139</span>,<span class="number">140</span>,<span class="number">42</span>,<span class="number">14</span>,<span class="number">14</span>,<span class="number">178</span>,<span class="number">94</span>,<span class="number">60</span>,<span class="number">175</span>,<span class="number">16</span>,<span class="number">179</span>,<span class="number">216</span>,<span class="number">14</span>,<span class="number">154</span>,<span class="number">220</span>,<span class="number">136</span>,<span class="number">176</span>,<span class="number">42</span>,<span class="number">145</span>,<span class="number">71</span>],[<span class="number">11</span>,<span class="number">190</span>,<span class="number">138</span>,<span class="number">143</span>,<span class="number">159</span>,<span class="number">121</span>,<span class="number">173</span>,<span class="number">115</span>,<span class="number">63</span>,<span class="number">200</span>,<span class="number">179</span>,<span class="number">44</span>,<span class="number">222</span>,<span class="number">85</span>,<span class="number">202</span>,<span class="number">143</span>,<span class="number">118</span>,<span class="number">197</span>,<span class="number">66</span>,<span class="number">100</span>,<span class="number">116</span>,<span class="number">18</span>,<span class="number">180</span>,<span class="number">77</span>,<span class="number">86</span>,<span class="number">175</span>,<span class="number">32</span>,<span class="number">158</span>,<span class="number">43</span>,<span class="number">133</span>,<span class="number">0</span>,<span class="number">214</span>,<span class="number">162</span>,<span class="number">118</span>,<span class="number">71</span>,<span class="number">224</span>,<span class="number">78</span>,<span class="number">175</span>,<span class="number">82</span>,<span class="number">206</span>,<span class="number">136</span>,<span class="number">137</span>,<span class="number">135</span>,<span class="number">41</span>,<span class="number">146</span>,<span class="number">130</span>,<span class="number">55</span>,<span class="number">42</span>,<span class="number">38</span>,<span class="number">115</span>,<span class="number">165</span>,<span class="number">53</span>,<span class="number">105</span>,<span class="number">189</span>,<span class="number">27</span>,<span class="number">86</span>,<span class="number">61</span>,<span class="number">98</span>,<span class="number">189</span>,<span class="number">7</span>,<span class="number">164</span>,<span class="number">152</span>,<span class="number">188</span>,<span class="number">132</span>,<span class="number">97</span>,<span class="number">2</span>,<span class="number">89</span>,<span class="number">210</span>,<span class="number">14</span>,<span class="number">131</span>,<span class="number">81</span>,<span class="number">11</span>,<span class="number">193</span>,<span class="number">164</span>,<span class="number">174</span>,<span class="number">180</span>,<span class="number">166</span>,<span class="number">112</span>,<span class="number">162</span>,<span class="number">197</span>,<span class="number">27</span>,<span class="number">27</span>,<span class="number">80</span>,<span class="number">120</span>,<span class="number">70</span>,<span class="number">98</span>,<span class="number">197</span>,<span class="number">29</span>,<span class="number">172</span>,<span class="number">88</span>,<span class="number">207</span>,<span class="number">76</span>,<span class="number">81</span>,<span class="number">205</span>,<span class="number">92</span>,<span class="number">37</span>,<span class="number">25</span>,<span class="number">189</span>,<span class="number">66</span>,<span class="number">94</span>,<span class="number">108</span>,<span class="number">222</span>,<span class="number">152</span>,<span class="number">93</span>,<span class="number">116</span>,<span class="number">141</span>,<span class="number">176</span>,<span class="number">72</span>,<span class="number">111</span>,<span class="number">171</span>,<span class="number">204</span>,<span class="number">146</span>,<span class="number">118</span>,<span class="number">5</span>,<span class="number">185</span>,<span class="number">39</span>,<span class="number">171</span>,<span class="number">180</span>,<span class="number">124</span>,<span class="number">78</span>,<span class="number">208</span>,<span class="number">142</span>,<span class="number">85</span>,<span class="number">120</span>,<span class="number">217</span>,<span class="number">61</span>,<span class="number">177</span>,<span class="number">39</span>,<span class="number">77</span>,<span class="number">57</span>,<span class="number">164</span>,<span class="number">139</span>,<span class="number">147</span>,<span class="number">171</span>,<span class="number">149</span>,<span class="number">111</span>,<span class="number">152</span>,<span class="number">168</span>,<span class="number">191</span>,<span class="number">33</span>,<span class="number">98</span>,<span class="number">11</span>,<span class="number">180</span>],[<span class="number">153</span>,<span class="number">44</span>,<span class="number">17</span>,<span class="number">75</span>,<span class="number">199</span>,<span class="number">75</span>,<span class="number">208</span>,<span class="number">31</span>,<span class="number">100</span>,<span class="number">124</span>,<span class="number">210</span>,<span class="number">206</span>,<span class="number">174</span>,<span class="number">223</span>,<span class="number">216</span>,<span class="number">194</span>,<span class="number">156</span>,<span class="number">157</span>,<span class="number">213</span>,<span class="number">101</span>,<span class="number">212</span>,<span class="number">117</span>,<span class="number">162</span>,<span class="number">194</span>,<span class="number">38</span>,<span class="number">184</span>,<span class="number">118</span>,<span class="number">126</span>,<span class="number">10</span>,<span class="number">92</span>,<span class="number">168</span>,<span class="number">197</span>,<span class="number">78</span>,<span class="number">113</span>,<span class="number">71</span>,<span class="number">154</span>,<span class="number">43</span>,<span class="number">177</span>,<span class="number">202</span>,<span class="number">115</span>,<span class="number">27</span>,<span class="number">34</span>,<span class="number">174</span>,<span class="number">54</span>,<span class="number">201</span>,<span class="number">97</span>,<span class="number">112</span>,<span class="number">180</span>,<span class="number">169</span>,<span class="number">32</span>,<span class="number">134</span>,<span class="number">160</span>,<span class="number">104</span>,<span class="number">183</span>,<span class="number">0</span>,<span class="number">145</span>,<span class="number">179</span>,<span class="number">106</span>,<span class="number">156</span>,<span class="number">182</span>,<span class="number">213</span>,<span class="number">214</span>,<span class="number">144</span>,<span class="number">43</span>,<span class="number">226</span>,<span class="number">191</span>,<span class="number">66</span>,<span class="number">34</span>,<span class="number">217</span>,<span class="number">187</span>,<span class="number">137</span>,<span class="number">40</span>,<span class="number">103</span>,<span class="number">194</span>,<span class="number">103</span>,<span class="number">217</span>,<span class="number">13</span>,<span class="number">87</span>,<span class="number">84</span>,<span class="number">151</span>,<span class="number">225</span>,<span class="number">190</span>,<span class="number">26</span>,<span class="number">100</span>,<span class="number">101</span>,<span class="number">30</span>,<span class="number">79</span>,<span class="number">173</span>,<span class="number">207</span>,<span class="number">32</span>,<span class="number">32</span>,<span class="number">150</span>,<span class="number">195</span>,<span class="number">105</span>,<span class="number">162</span>,<span class="number">78</span>,<span class="number">61</span>,<span class="number">16</span>,<span class="number">32</span>,<span class="number">151</span>,<span class="number">4</span>,<span class="number">59</span>,<span class="number">50</span>,<span class="number">219</span>,<span class="number">220</span>,<span class="number">133</span>,<span class="number">13</span>,<span class="number">31</span>,<span class="number">104</span>,<span class="number">122</span>,<span class="number">93</span>,<span class="number">181</span>,<span class="number">5</span>,<span class="number">150</span>,<span class="number">188</span>,<span class="number">25</span>,<span class="number">222</span>,<span class="number">77</span>,<span class="number">111</span>,<span class="number">2</span>,<span class="number">41</span>,<span class="number">12</span>,<span class="number">129</span>,<span class="number">138</span>,<span class="number">107</span>,<span class="number">74</span>,<span class="number">30</span>,<span class="number">145</span>,<span class="number">21</span>,<span class="number">165</span>,<span class="number">192</span>,<span class="number">115</span>,<span class="number">119</span>,<span class="number">118</span>,<span class="number">112</span>,<span class="number">223</span>,<span class="number">74</span>,<span class="number">76</span>,<span class="number">167</span>,<span class="number">167</span>,<span class="number">218</span>,<span class="number">80</span>,<span class="number">121</span>]])</span><br><span class="line">P = [[<span class="number">0</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">143</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">143</span>)]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">143</span>):</span><br><span class="line">    P[i][i] = p</span><br><span class="line">M = M.stack(Matrix(P))</span><br><span class="line">lattice = IntegerLattice(M, lll_reduce=<span class="literal">True</span>)</span><br><span class="line">c = vector([<span class="number">158</span>,<span class="number">93</span>,<span class="number">224</span>,<span class="number">147</span>,<span class="number">157</span>,<span class="number">86</span>,<span class="number">28</span>,<span class="number">224</span>,<span class="number">141</span>,<span class="number">124</span>,<span class="number">150</span>,<span class="number">117</span>,<span class="number">110</span>,<span class="number">88</span>,<span class="number">186</span>,<span class="number">115</span>,<span class="number">109</span>,<span class="number">119</span>,<span class="number">166</span>,<span class="number">206</span>,<span class="number">210</span>,<span class="number">89</span>,<span class="number">28</span>,<span class="number">63</span>,<span class="number">110</span>,<span class="number">16</span>,<span class="number">156</span>,<span class="number">125</span>,<span class="number">122</span>,<span class="number">201</span>,<span class="number">147</span>,<span class="number">185</span>,<span class="number">53</span>,<span class="number">211</span>,<span class="number">46</span>,<span class="number">1</span>,<span class="number">100</span>,<span class="number">217</span>,<span class="number">69</span>,<span class="number">12</span>,<span class="number">147</span>,<span class="number">64</span>,<span class="number">136</span>,<span class="number">20</span>,<span class="number">88</span>,<span class="number">198</span>,<span class="number">43</span>,<span class="number">110</span>,<span class="number">126</span>,<span class="number">101</span>,<span class="number">113</span>,<span class="number">81</span>,<span class="number">170</span>,<span class="number">190</span>,<span class="number">93</span>,<span class="number">82</span>,<span class="number">10</span>,<span class="number">217</span>,<span class="number">184</span>,<span class="number">32</span>,<span class="number">39</span>,<span class="number">18</span>,<span class="number">184</span>,<span class="number">214</span>,<span class="number">24</span>,<span class="number">190</span>,<span class="number">78</span>,<span class="number">152</span>,<span class="number">160</span>,<span class="number">62</span>,<span class="number">152</span>,<span class="number">38</span>,<span class="number">214</span>,<span class="number">16</span>,<span class="number">37</span>,<span class="number">28</span>,<span class="number">125</span>,<span class="number">51</span>,<span class="number">20</span>,<span class="number">54</span>,<span class="number">91</span>,<span class="number">220</span>,<span class="number">214</span>,<span class="number">47</span>,<span class="number">95</span>,<span class="number">113</span>,<span class="number">140</span>,<span class="number">226</span>,<span class="number">133</span>,<span class="number">185</span>,<span class="number">11</span>,<span class="number">214</span>,<span class="number">207</span>,<span class="number">189</span>,<span class="number">94</span>,<span class="number">92</span>,<span class="number">223</span>,<span class="number">34</span>,<span class="number">61</span>,<span class="number">168</span>,<span class="number">191</span>,<span class="number">163</span>,<span class="number">152</span>,<span class="number">203</span>,<span class="number">201</span>,<span class="number">215</span>,<span class="number">106</span>,<span class="number">180</span>,<span class="number">114</span>,<span class="number">140</span>,<span class="number">198</span>,<span class="number">177</span>,<span class="number">215</span>,<span class="number">201</span>,<span class="number">208</span>,<span class="number">152</span>,<span class="number">221</span>,<span class="number">0</span>,<span class="number">59</span>,<span class="number">147</span>,<span class="number">205</span>,<span class="number">3</span>,<span class="number">181</span>,<span class="number">104</span>,<span class="number">199</span>,<span class="number">205</span>,<span class="number">27</span>,<span class="number">145</span>,<span class="number">51</span>,<span class="number">105</span>,<span class="number">83</span>,<span class="number">17</span>,<span class="number">32</span>,<span class="number">221</span>,<span class="number">214</span>,<span class="number">194</span>,<span class="number">193</span>,<span class="number">148</span>,<span class="number">65</span>,<span class="number">20</span>,<span class="number">183</span>,<span class="number">102</span>,<span class="number">174</span>])</span><br><span class="line"><span class="string">&#x27;[&#x27;</span>+<span class="built_in">str</span>(BabaisClosestPlaneAlgorithm(lattice.reduced_basis, c))[<span class="number">1</span>:-<span class="number">1</span>]+<span class="string">&#x27;]&#x27;</span></span><br></pre></td></tr></table></figure>



<h1 id="secrets"><a href="#secrets" class="headerlink" title="secrets"></a>secrets</h1><h2 id="problem-2"><a href="#problem-2" class="headerlink" title="problem"></a>problem</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random, hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(flag[:<span class="number">5</span>] == <span class="string">b&quot;flag&#123;&quot;</span> <span class="keyword">and</span> flag[-<span class="number">1</span>:] == <span class="string">b&quot;&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">flag = flag[<span class="number">5</span>:-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">secrets = [getPrime(<span class="number">32</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line">a = [getPrime(<span class="number">511</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">e = [[random.randint(<span class="number">0</span>,<span class="number">2</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>)]</span><br><span class="line"></span><br><span class="line">c = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">    tmp = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        tmp *= secrets[j] ** e[i][j]</span><br><span class="line">    c += a[i] * tmp</span><br><span class="line">    c %= p</span><br><span class="line"></span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(secrets).encode()).digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">enc_flag = cipher.encrypt(flag).<span class="built_in">hex</span>()</span><br><span class="line"></span><br><span class="line">print(p)</span><br><span class="line">print(a)</span><br><span class="line">print(e)</span><br><span class="line">print(c)</span><br><span class="line">print(enc_flag)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">12974234240047250882827277463970749648223428465145328709918053842153820677294215343957019413719473165129078971772191068642653862027980142472460705711018201</span></span><br><span class="line"><span class="string">[6208495304507502877592974397978564449062722480435998477821753565334623511793847345749111308898139670628857817327159494561065840693449298616913891952427947, 4428365792626193951517975036630823002373517124620690551190165499794155382003347632615508488697880129516880024881940903287205636949002132541035487795791827, 4718311857821047798142460474602800502374374326300654458450570361490723801361197812174259099714079434910279510299556693616702570294307587124784370853830179]</span></span><br><span class="line"><span class="string">[[0, 2, 2], [1, 0, 1], [2, 1, 1]]</span></span><br><span class="line"><span class="string">8024639827831958040886215528711059283414630802186262470325506233115495366865722141662305750597559580380055075908821369972992187624854877285935207126822671</span></span><br><span class="line"><span class="string">bf550e796d6efc92e8543ffcbb8d81fd588900f8f7aecaeeee718d60eaace3bc</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>背包问题<br>$$<br>(s_1s_2)^2 a_0 + s_0s_2a_1 + s^2_0s_1s_2a_2 + kp - c = 0<br>$$<br>经典一个等式流<br>$$<br>((s_1s_2)^2 , s_0s_2 , s^2_0s_1s_2,1,k)<br>\begin{pmatrix}<br>1&amp;0&amp;0&amp;0&amp;a_0\cdot R \<br>0&amp;1&amp;0&amp;0&amp;a_1 \cdot R\<br>0&amp;0&amp;1&amp;0&amp;a_2 \cdot R\<br>0&amp;0&amp;0&amp;1&amp;-c \cdot R\<br>0&amp;0&amp;0&amp;0&amp;p \cdot R\<br>\end{pmatrix}<br>=<br>((s_1s_2)^2 , s_0s_2 , s^2_0s_1s_2,1,0)<br>,R = 2 ^ i<br>$$<br>这里的$R$是为了调格子的det, 调到能找到目标向量为止, 找到等式右边的向量就能算出$s_0,s_1,s_2$</p>
<h2 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random, hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line">enc_flag = <span class="number">0xbf550e796d6efc92e8543ffcbb8d81fd588900f8f7aecaeeee718d60eaace3bc</span></span><br><span class="line">a  = [<span class="number">6208495304507502877592974397978564449062722480435998477821753565334623511793847345749111308898139670628857817327159494561065840693449298616913891952427947</span>, <span class="number">4428365792626193951517975036630823002373517124620690551190165499794155382003347632615508488697880129516880024881940903287205636949002132541035487795791827</span>, <span class="number">4718311857821047798142460474602800502374374326300654458450570361490723801361197812174259099714079434910279510299556693616702570294307587124784370853830179</span>]</span><br><span class="line"></span><br><span class="line">p = <span class="number">12974234240047250882827277463970749648223428465145328709918053842153820677294215343957019413719473165129078971772191068642653862027980142472460705711018201</span></span><br><span class="line">c = <span class="number">8024639827831958040886215528711059283414630802186262470325506233115495366865722141662305750597559580380055075908821369972992187624854877285935207126822671</span></span><br><span class="line"></span><br><span class="line">i = <span class="number">128</span></span><br><span class="line"></span><br><span class="line">R = <span class="number">2</span>**i</span><br><span class="line">M = Matrix([[<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,a[<span class="number">0</span>] * R],[<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>,a[<span class="number">1</span>] * R],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,a[<span class="number">2</span>] * R],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,-c * R],[<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,p * R]])</span><br><span class="line">L = M.BKZ()</span><br><span class="line"></span><br><span class="line">s3 = gcd(L[<span class="number">0</span>][<span class="number">0</span>],<span class="built_in">abs</span>(L[<span class="number">0</span>][<span class="number">1</span>]))</span><br><span class="line">s1 = <span class="built_in">abs</span>(L[<span class="number">0</span>][<span class="number">1</span>]) // s3</span><br><span class="line">s2 = sqrt(<span class="built_in">abs</span>(L[<span class="number">0</span>][<span class="number">0</span>]) // s3 // s3)</span><br><span class="line">secrets = [s1,s2,s3]</span><br><span class="line"></span><br><span class="line">key = hashlib.sha256(<span class="built_in">str</span>(secrets).encode()).digest()</span><br><span class="line">cipher = AES.new(key, AES.MODE_ECB)</span><br><span class="line">flag = cipher.decrypt(long_to_bytes(enc_flag))</span><br><span class="line">flag</span><br></pre></td></tr></table></figure>



<h1 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h1><h2 id="problem-3"><a href="#problem-3" class="headerlink" title="problem"></a>problem</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">0x10001</span></span><br><span class="line">x = (p ^ q) &amp; ((<span class="number">1</span> &lt;&lt; <span class="number">400</span>) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m,e,n)</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;c = &quot;</span> + <span class="built_in">str</span>(c))</span><br><span class="line">print(<span class="string">&quot;e = &quot;</span> + <span class="built_in">str</span>(e))</span><br><span class="line">print(<span class="string">&quot;n = &quot;</span> + <span class="built_in">str</span>(n))</span><br><span class="line">print(<span class="string">&quot;x = &quot;</span> + <span class="built_in">str</span>(x))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 41079136228776331983513986502894911009747944746334405367181525535644429164244074690458675696682154772257649811625401364517966224711291000199478649309514306511977247475050430881892635166215911325729515065570801798281126631754714292634605360578171629351703909902943766832088848829679735266081587467028354629832</span></span><br><span class="line"><span class="string">e = 65537</span></span><br><span class="line"><span class="string">n = 88873300622677925132392673651975872286851841516213062658793503010409158793653030553313986481205677326846210604582870123515082097235868012724220463515351466605298734168814756198761860328588678124560858545154560701982246840286690871368569184620040790812223630254910190657002367120010677907467764741789052920477</span></span><br><span class="line"><span class="string">x = 138384108215091704603441412066611031482512354164750119910659929381838248956079740784293945420743011870999379776464932828</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<p>plaidCTF 2021里面的那个xorsa改了一下</p>
<p>把给出来的p ^ q 的位数减少到了400位</p>
<p>依旧可以用bfs得到p的低400左右的位数</p>
<p>然后copper   p一共就512位</p>
<h2 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"></span><br><span class="line">c = <span class="number">41079136228776331983513986502894911009747944746334405367181525535644429164244074690458675696682154772257649811625401364517966224711291000199478649309514306511977247475050430881892635166215911325729515065570801798281126631754714292634605360578171629351703909902943766832088848829679735266081587467028354629832</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">n = <span class="number">88873300622677925132392673651975872286851841516213062658793503010409158793653030553313986481205677326846210604582870123515082097235868012724220463515351466605298734168814756198761860328588678124560858545154560701982246840286690871368569184620040790812223630254910190657002367120010677907467764741789052920477</span></span><br><span class="line">x = <span class="built_in">bin</span>(<span class="number">138384108215091704603441412066611031482512354164750119910659929381838248956079740784293945420743011870999379776464932828</span>)[<span class="number">2</span>:]</span><br><span class="line">P = []</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find</span>(<span class="params">guessp,i</span>):</span></span><br><span class="line">    p = <span class="built_in">int</span>(guessp,<span class="number">2</span>)</span><br><span class="line">    q = <span class="built_in">int</span>(x[-i:],<span class="number">2</span>) ^^ p</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (q * p) % <span class="number">2</span> ** i == n % <span class="number">2</span> ** i:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">399</span>:</span><br><span class="line">            P.append(p)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            find(<span class="string">&#x27;1&#x27;</span>+guessp,i+<span class="number">1</span>)</span><br><span class="line">            find(<span class="string">&#x27;0&#x27;</span>+guessp,i+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">find(<span class="string">&#x27;1&#x27;</span>,<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="built_in">len</span>(P))</span><br><span class="line">pbits = <span class="number">512</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="built_in">len</span>(P))):</span><br><span class="line">    _p = P[i]</span><br><span class="line">    kbits = <span class="number">512</span> - <span class="built_in">len</span>(<span class="built_in">bin</span>(_p)[<span class="number">2</span>:])</span><br><span class="line">    R.&lt;x&gt; = Zmod(n)[]</span><br><span class="line">    f = P[i] + x * <span class="number">2</span>^<span class="built_in">len</span>(<span class="built_in">bin</span>(_p)[<span class="number">2</span>:])</span><br><span class="line">    f = f.monic()</span><br><span class="line">    roots = f.small_roots(X=<span class="number">2</span>^kbits,beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        p = <span class="built_in">int</span>(_p + roots[<span class="number">0</span>]* <span class="number">2</span>^<span class="built_in">len</span>(<span class="built_in">bin</span>(_p)[<span class="number">2</span>:]))</span><br><span class="line">        print(_p + roots[<span class="number">0</span>]* <span class="number">2</span>^<span class="built_in">len</span>(<span class="built_in">bin</span>(_p)[<span class="number">2</span>:]))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">q = n // p</span><br><span class="line"><span class="keyword">assert</span> p * q == n</span><br><span class="line">phi = (q - <span class="number">1</span>) * (p - <span class="number">1</span>)</span><br><span class="line">d = inverse_mod(e,phi)</span><br><span class="line">long_to_bytes(<span class="built_in">pow</span>(c,d,n))</span><br></pre></td></tr></table></figure>


        </div></article>
      <nav class="pagination"><a class="prev" href="/page/3/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text">Prev</span>
      </a>
    <a class="next" href="/page/5/">
        <span class="next-text">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    </nav></section></div></div>
      </main>

      <footer id="footer" class="footer"><div class="social-links"><a href="mailto:your@email.com" class="iconfont icon-email" title="email"></a>
        <a target="_blank" rel="noopener" href="https://github.com/tearsjin" class="iconfont icon-github" title="github"></a>
        <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    </div><div class="copyright">
  <span class="power-by">
    Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    Theme - 
    <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/ahonn/hexo-theme-even">Even</a>
  </span>

  <span class="copyright-year">&copy;2020 - 2022<span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">K1rit0</span>
  </span>
</div>
</footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div><script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/src/even.js?v=2.11.0"></script>
</body>
</html>
